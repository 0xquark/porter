debug = true
debug-plugins = true

default-storage-plugin = "mongodb-docker"
default-storage = "dev"
default-secrets-plugin = "azure.keyvault"
default-secrets = "red-team"

experimental = ["structured-logs"]

# Keep this line because while there is only one build driver now, we may add more in the future
build-driver = "buildkit"

[logs]
  enabled = true
  level = "info"

[telemetry]
  enabled = true
  redirect-to-file = true

[[storage]]
  name = "dev"
  plugin = "mongodb"

  [storage.config]
    url = "${secret.connection-string}"

[[secrets]]
  name = "red-team"
  plugin = "azure.keyvault"

  [secrets.config]
    token = "${env.VAULT_TOKEN}"
    vault = "teamsekrets"
